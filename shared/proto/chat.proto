syntax = "proto3";

package chat;
option go_package = "./chat;chat";

service ChatService {
  rpc StreamChat(ChatRequest) returns (stream ChatResponse);
  rpc GetChatHistory(HistoryRequest) returns (HistoryResponse);
  rpc CreateSession(CreateSessionRequest) returns (CreateSessionResponse);
  rpc DeleteSession(DeleteSessionRequest) returns (DeleteSessionResponse);
}

message ChatRequest {
  string user_id = 1;
  string session_id = 2;
  string message = 3;
  string model = 4;
  ChatConfig config = 5;
}

message ChatResponse {
  string session_id = 1;
  string token = 2;
  bool is_finished = 3;
  string error = 4;
  int32 generated_tokens = 5;
}

message ChatConfig {
  float temperature = 1;
  int32 max_tokens = 2;
  repeated string stop_words = 3;
  float top_p = 4;
  int32 top_k = 5;
}

message HistoryRequest {
  string user_id = 1;
  string session_id = 2;
  int32 limit = 3;
  int32 offset = 4;
}

message HistoryResponse {
  repeated ChatMessage messages = 1;
  int32 total = 2;
}

message ChatMessage {
  string id = 1;
  string session_id = 2;
  string role = 3;
  string content = 4;
  int64 timestamp = 5;
}

message CreateSessionRequest {
  string user_id = 1;
  string title = 2;
}

message CreateSessionResponse {
  bool success = 1;
  string session_id = 2;
  string message = 3;
}

message DeleteSessionRequest {
  string user_id = 1;
  string session_id = 2;
}

message DeleteSessionResponse {
  bool success = 1;
  string message = 2;
}